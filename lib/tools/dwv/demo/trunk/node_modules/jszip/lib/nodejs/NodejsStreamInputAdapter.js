"use strict";var utils=require("../utils"),GenericWorker=require("../stream/GenericWorker");function NodejsStreamInputAdapter(e,r){GenericWorker.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(r)}utils.inherits(NodejsStreamInputAdapter,GenericWorker),NodejsStreamInputAdapter.prototype._bindStream=function(e){var r=this;this._stream=e,e.pause(),e.on("data",(function(e){r.push({data:e,meta:{percent:0}})})).on("error",(function(e){r.isPaused?this.generatedError=e:r.error(e)})).on("end",(function(){r.isPaused?r._upstreamEnded=!0:r.end()}))},NodejsStreamInputAdapter.prototype.pause=function(){return!!GenericWorker.prototype.pause.call(this)&&(this._stream.pause(),!0)},NodejsStreamInputAdapter.prototype.resume=function(){return!!GenericWorker.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},module.exports=NodejsStreamInputAdapter;
