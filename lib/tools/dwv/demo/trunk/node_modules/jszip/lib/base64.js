"use strict";var utils=require("./utils"),support=require("./support"),_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";exports.encode=function(r){for(var t,e,a,n,h,i,c,o=[],u=0,A=r.length,s=A,l="string"!==utils.getTypeOf(r);u<r.length;)s=A-u,l?(t=r[u++],e=u<A?r[u++]:0,a=u<A?r[u++]:0):(t=r.charCodeAt(u++),e=u<A?r.charCodeAt(u++):0,a=u<A?r.charCodeAt(u++):0),n=t>>2,h=(3&t)<<4|e>>4,i=s>1?(15&e)<<2|a>>6:64,c=s>2?63&a:64,o.push(_keyStr.charAt(n)+_keyStr.charAt(h)+_keyStr.charAt(i)+_keyStr.charAt(c));return o.join("")},exports.decode=function(r){var t,e,a,n,h,i,c=0,o=0,u="data:";if(r.substr(0,5)===u)throw new Error("Invalid base64 input, it looks like a data url.");var A,s=3*(r=r.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(r.charAt(r.length-1)===_keyStr.charAt(64)&&s--,r.charAt(r.length-2)===_keyStr.charAt(64)&&s--,s%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=support.uint8array?new Uint8Array(0|s):new Array(0|s);c<r.length;)t=_keyStr.indexOf(r.charAt(c++))<<2|(n=_keyStr.indexOf(r.charAt(c++)))>>4,e=(15&n)<<4|(h=_keyStr.indexOf(r.charAt(c++)))>>2,a=(3&h)<<6|(i=_keyStr.indexOf(r.charAt(c++))),A[o++]=t,64!==h&&(A[o++]=e),64!==i&&(A[o++]=a);return A};
