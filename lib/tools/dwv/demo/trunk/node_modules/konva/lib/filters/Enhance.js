import{Factory}from"../Factory.js";import{Node}from"../Node.js";import{getNumberValidator}from"../Validators.js";function remap(r,t,e,a,o){var n=e-t,m=o-a;return 0===n?a+m/2:0===m?a:m*((r-t)/n)+a}export const Enhance=function(r){var t,e,a,o,n=r.data,m=n.length,i=n[0],c=i,d=n[1],f=d,p=n[2],s=p,h=this.enhance();if(0!==h){for(o=0;o<m;o+=4)(t=n[o+0])<i?i=t:t>c&&(c=t),(e=n[o+1])<d?d=e:e>f&&(f=e),(a=n[o+2])<p?p=a:a>s&&(s=a);var l,u,F,N,y,g,j,v,V;for(c===i&&(c=255,i=0),f===d&&(f=255,d=0),s===p&&(s=255,p=0),h>0?(u=c+h*(255-c),F=i-h*(i-0),y=f+h*(255-f),g=d-h*(d-0),v=s+h*(255-s),V=p-h*(p-0)):(u=c+h*(c-(l=.5*(c+i))),F=i+h*(i-l),y=f+h*(f-(N=.5*(f+d))),g=d+h*(d-N),v=s+h*(s-(j=.5*(s+p))),V=p+h*(p-j)),o=0;o<m;o+=4)n[o+0]=remap(n[o+0],i,c,F,u),n[o+1]=remap(n[o+1],d,f,g,y),n[o+2]=remap(n[o+2],p,s,V,v)}};Factory.addGetterSetter(Node,"enhance",0,getNumberValidator(),Factory.afterSetFilter);
