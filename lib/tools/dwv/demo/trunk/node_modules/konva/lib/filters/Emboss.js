import{Factory}from"../Factory.js";import{Node}from"../Node.js";import{Util}from"../Util.js";import{getNumberValidator}from"../Validators.js";export const Emboss=function(e){var t=10*this.embossStrength(),r=255*this.embossWhiteLevel(),o=this.embossDirection(),a=this.embossBlend(),s=0,i=0,l=e.data,d=e.width,b=e.height,c=4*d,m=b;switch(o){case"top-left":s=-1,i=-1;break;case"top":s=-1,i=0;break;case"top-right":s=-1,i=1;break;case"right":s=0,i=1;break;case"bottom-right":s=1,i=1;break;case"bottom":s=1,i=0;break;case"bottom-left":s=1,i=-1;break;case"left":s=0,i=-1;break;default:Util.error("Unknown emboss direction: "+o)}do{var h=(m-1)*c,f=s;m+f<1&&(f=0),m+f>b&&(f=0);var n=(m-1+f)*d*4,F=d;do{var y=h+4*(F-1),S=i;F+S<1&&(S=0),F+S>d&&(S=0);var g=n+4*(F-1+S),k=l[y]-l[g],p=l[y+1]-l[g+1],v=l[y+2]-l[g+2],N=k,u=N>0?N:-N;if((p>0?p:-p)>u&&(N=p),(v>0?v:-v)>u&&(N=v),N*=t,a){var w=l[y]+N,j=l[y+1]+N,G=l[y+2]+N;l[y]=w>255?255:w<0?0:w,l[y+1]=j>255?255:j<0?0:j,l[y+2]=G>255?255:G<0?0:G}else{var U=r-N;U<0?U=0:U>255&&(U=255),l[y]=l[y+1]=l[y+2]=U}}while(--F)}while(--m)};Factory.addGetterSetter(Node,"embossStrength",.5,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"embossWhiteLevel",.5,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"embossDirection","top-left",null,Factory.afterSetFilter),Factory.addGetterSetter(Node,"embossBlend",!1,null,Factory.afterSetFilter);
