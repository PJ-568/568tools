"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Enhance=void 0;const Factory_1=require("../Factory"),Node_1=require("../Node"),Validators_1=require("../Validators");function remap(e,r,t,a,o){var n=t-r,c=o-a;return 0===n?a+c/2:0===c?a:c*((e-r)/n)+a}const Enhance=function(e){var r,t,a,o,n=e.data,c=n.length,i=n[0],d=i,s=n[1],u=s,_=n[2],h=_,l=this.enhance();if(0!==l){for(o=0;o<c;o+=4)(r=n[o+0])<i?i=r:r>d&&(d=r),(t=n[o+1])<s?s=t:t>u&&(u=t),(a=n[o+2])<_?_=a:a>h&&(h=a);var p,f,y,F,m,v,N,E,V;for(d===i&&(d=255,i=0),u===s&&(u=255,s=0),h===_&&(h=255,_=0),l>0?(f=d+l*(255-d),y=i-l*(i-0),m=u+l*(255-u),v=s-l*(s-0),E=h+l*(255-h),V=_-l*(_-0)):(f=d+l*(d-(p=.5*(d+i))),y=i+l*(i-p),m=u+l*(u-(F=.5*(u+s))),v=s+l*(s-F),E=h+l*(h-(N=.5*(h+_))),V=_+l*(_-N)),o=0;o<c;o+=4)n[o+0]=remap(n[o+0],i,d,y,f),n[o+1]=remap(n[o+1],s,u,v,m),n[o+2]=remap(n[o+2],_,h,V,E)}};exports.Enhance=Enhance,Factory_1.Factory.addGetterSetter(Node_1.Node,"enhance",0,(0,Validators_1.getNumberValidator)(),Factory_1.Factory.afterSetFilter);
