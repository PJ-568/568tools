"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Emboss=void 0;const Factory_1=require("../Factory"),Node_1=require("../Node"),Util_1=require("../Util"),Validators_1=require("../Validators"),Emboss=function(e){var t=10*this.embossStrength(),r=255*this.embossWhiteLevel(),o=this.embossDirection(),a=this.embossBlend(),s=0,i=0,d=e.data,c=e.width,l=e.height,b=4*c,F=l;switch(o){case"top-left":s=-1,i=-1;break;case"top":s=-1,i=0;break;case"top-right":s=-1,i=1;break;case"right":s=0,i=1;break;case"bottom-right":s=1,i=1;break;case"bottom":s=1,i=0;break;case"bottom-left":s=1,i=-1;break;case"left":s=0,i=-1;break;default:Util_1.Util.error("Unknown emboss direction: "+o)}do{var _=(F-1)*b,y=s;F+y<1&&(y=0),F+y>l&&(y=0);var m=(F-1+y)*c*4,h=c;do{var n=_+4*(h-1),u=i;h+u<1&&(u=0),h+u>c&&(u=0);var f=m+4*(h-1+u),N=d[n]-d[f],v=d[n+1]-d[f+1],S=d[n+2]-d[f+2],k=N,g=k>0?k:-k;if((v>0?v:-v)>g&&(k=v),(S>0?S:-S)>g&&(k=S),k*=t,a){var p=d[n]+k,V=d[n+1]+k,w=d[n+2]+k;d[n]=p>255?255:p<0?0:p,d[n+1]=V>255?255:V<0?0:V,d[n+2]=w>255?255:w<0?0:w}else{var U=r-k;U<0?U=0:U>255&&(U=255),d[n]=d[n+1]=d[n+2]=U}}while(--h)}while(--F)};exports.Emboss=Emboss,Factory_1.Factory.addGetterSetter(Node_1.Node,"embossStrength",.5,(0,Validators_1.getNumberValidator)(),Factory_1.Factory.afterSetFilter),Factory_1.Factory.addGetterSetter(Node_1.Node,"embossWhiteLevel",.5,(0,Validators_1.getNumberValidator)(),Factory_1.Factory.afterSetFilter),Factory_1.Factory.addGetterSetter(Node_1.Node,"embossDirection","top-left",null,Factory_1.Factory.afterSetFilter),Factory_1.Factory.addGetterSetter(Node_1.Node,"embossBlend",!1,null,Factory_1.Factory.afterSetFilter);
