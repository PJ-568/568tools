"use strict";var utils=require("../utils/common"),MAXBITS=15,ENOUGH_LENS=852,ENOUGH_DISTS=592,CODES=0,LENS=1,DISTS=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function(r,S,e,f,t,i,u,o){var E,l,s,n,I,N,T,B,D,O=o.bits,b=0,a=0,A=0,L=0,M=0,X=0,d=0,G=0,H=0,U=0,_=null,x=0,c=new utils.Buf16(MAXBITS+1),m=new utils.Buf16(MAXBITS+1),w=null,C=0;for(b=0;b<=MAXBITS;b++)c[b]=0;for(a=0;a<f;a++)c[S[e+a]]++;for(M=O,L=MAXBITS;L>=1&&0===c[L];L--);if(M>L&&(M=L),0===L)return t[i++]=20971520,t[i++]=20971520,o.bits=1,0;for(A=1;A<L&&0===c[A];A++);for(M<A&&(M=A),G=1,b=1;b<=MAXBITS;b++)if(G<<=1,(G-=c[b])<0)return-1;if(G>0&&(r===CODES||1!==L))return-1;for(m[1]=0,b=1;b<MAXBITS;b++)m[b+1]=m[b]+c[b];for(a=0;a<f;a++)0!==S[e+a]&&(u[m[S[e+a]]++]=a);if(r===CODES?(_=w=u,N=19):r===LENS?(_=lbase,x-=257,w=lext,C-=257,N=256):(_=dbase,w=dext,N=-1),U=0,a=0,b=A,I=i,X=M,d=0,s=-1,n=(H=1<<M)-1,r===LENS&&H>ENOUGH_LENS||r===DISTS&&H>ENOUGH_DISTS)return 1;for(;;){T=b-d,u[a]<N?(B=0,D=u[a]):u[a]>N?(B=w[C+u[a]],D=_[x+u[a]]):(B=96,D=0),E=1<<b-d,A=l=1<<X;do{t[I+(U>>d)+(l-=E)]=T<<24|B<<16|D|0}while(0!==l);for(E=1<<b-1;U&E;)E>>=1;if(0!==E?(U&=E-1,U+=E):U=0,a++,0==--c[b]){if(b===L)break;b=S[e+u[a]]}if(b>M&&(U&n)!==s){for(0===d&&(d=M),I+=A,G=1<<(X=b-d);X+d<L&&!((G-=c[X+d])<=0);)X++,G<<=1;if(H+=1<<X,r===LENS&&H>ENOUGH_LENS||r===DISTS&&H>ENOUGH_DISTS)return 1;t[s=U&n]=M<<24|X<<16|I-i|0}}return 0!==U&&(t[I+U]=b-d<<24|64<<16|0),o.bits=M,0};
