"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Pixelate=void 0;const Factory_1=require("../Factory"),Util_1=require("../Util"),Node_1=require("../Node"),Validators_1=require("../Validators"),Pixelate=function(e){var t,r,i,o,a,l,d,c,f,s,_,u,x,h,p=Math.ceil(this.pixelSize()),y=e.width,F=e.height,n=Math.ceil(y/p),N=Math.ceil(F/p),P=e.data;if(p<=0)Util_1.Util.error("pixelSize value can not be <= 0");else for(u=0;u<n;u+=1)for(x=0;x<N;x+=1){for(o=0,a=0,l=0,d=0,f=(c=u*p)+p,_=(s=x*p)+p,h=0,t=c;t<f;t+=1)if(!(t>=y))for(r=s;r<_;r+=1)r>=F||(o+=P[(i=4*(y*r+t))+0],a+=P[i+1],l+=P[i+2],d+=P[i+3],h+=1);for(o/=h,a/=h,l/=h,d/=h,t=c;t<f;t+=1)if(!(t>=y))for(r=s;r<_;r+=1)r>=F||(P[(i=4*(y*r+t))+0]=o,P[i+1]=a,P[i+2]=l,P[i+3]=d)}};exports.Pixelate=Pixelate,Factory_1.Factory.addGetterSetter(Node_1.Node,"pixelSize",8,(0,Validators_1.getNumberValidator)(),Factory_1.Factory.afterSetFilter);
